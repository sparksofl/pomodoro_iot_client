'use strict';










jest.unmock('NavigationScenesReducer');






function testTransition(states){
var navigationStates=states.map(function(keys){
return {
children:keys.map(function(key){
return {key:key};})};});




var scenes=[];
var prevState=null;
navigationStates.forEach(function(nextState){
scenes=require('NavigationScenesReducer')(scenes,nextState,prevState);
prevState=nextState;});


return scenes;}


describe('NavigationScenesReducer',function(){

it('gets initial scenes',function(){
var scenes=testTransition([
['1','2']]);


expect(scenes).toEqual([
{
'index':0,
'isStale':false,
'key':'scene_1',
'navigationState':{
'key':'1'}},


{
'index':1,
'isStale':false,
'key':'scene_2',
'navigationState':{
'key':'2'}}]);});





it('pushes new scenes',function(){

var scenes=testTransition([
['1','2'],
['1','2','3']]);


expect(scenes).toEqual([
{
'index':0,
'isStale':false,
'key':'scene_1',
'navigationState':{
'key':'1'}},


{
'index':1,
'isStale':false,
'key':'scene_2',
'navigationState':{
'key':'2'}},


{
'index':2,
'isStale':false,
'key':'scene_3',
'navigationState':{
'key':'3'}}]);});





it('pops scenes',function(){

var scenes=testTransition([
['1','2','3'],
['1','2']]);


expect(scenes).toEqual([
{
'index':0,
'isStale':false,
'key':'scene_1',
'navigationState':{
'key':'1'}},


{
'index':1,
'isStale':false,
'key':'scene_2',
'navigationState':{
'key':'2'}},


{
'index':2,
'isStale':true,
'key':'scene_3',
'navigationState':{
'key':'3'}}]);});





it('replaces scenes',function(){
var scenes=testTransition([
['1','2'],
['3']]);


expect(scenes).toEqual([
{
'index':0,
'isStale':true,
'key':'scene_1',
'navigationState':{
'key':'1'}},


{
'index':0,
'isStale':false,
'key':'scene_3',
'navigationState':{
'key':'3'}},


{
'index':1,
'isStale':true,
'key':'scene_2',
'navigationState':{
'key':'2'}}]);});





it('revives scenes',function(){
var scenes=testTransition([
['1','2'],
['3'],
['2']]);


expect(scenes).toEqual([
{
'index':0,
'isStale':true,
'key':'scene_1',
'navigationState':{
'key':'1'}},


{
'index':0,
'isStale':false,
'key':'scene_2',
'navigationState':{
'key':'2'}},


{
'index':0,
'isStale':true,
'key':'scene_3',
'navigationState':{
'key':'3'}}]);});});